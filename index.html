<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Backbone.leaflet by LuizArmesto</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Backbone.leaflet</h1>
          <h2>A map component for Backbone.js</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/LuizArmesto/backbone.leaflet/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/LuizArmesto/backbone.leaflet/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/LuizArmesto/backbone.leaflet" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>Backbone.Leaflet (0.0.1-dev)</h1>

<p><a href="http://travis-ci.org/LuizArmesto/backbone.leaflet"><img src="https://secure.travis-ci.org/LuizArmesto/backbone.leaflet.png" alt="Continuous Integration status"></a></p>

<p><em>(Disclaimer: This project is in an early development stage. It is not intended to be used in production yet!)</em></p>

<p><strong>Backbone.Leaflet</strong> is a <a href="http://backbonejs.org/">Backbone</a> plugin designed to work with geospatial data using <a href="http://geojson.org">GeoJSON</a> specification, providing an extended model (<code>Backbone.Leaflet.GeoModel</code>) and an extended collection (<code>Backbone.Leaflet.GeoCollection</code>) that accepts and exports GeoJSON data and a couple of views (<code>Backbone.Leaflet.MapView</code> and <code>Backbone.Leaflet.SatelliteView</code>) to display <code>GeoModel</code> instances in a map, using <a href="http://leafletjs.com">Leaflet</a>.</p>

<p>You should be familiar with both Backbone and Leaflet to get the best use out of this plugin.</p>

<p><strong>Dependencies</strong>:</p>

<ul>
<li>
<a href="http://backbonejs.org/#downloads">Backbone 1.0.0</a> and it dependencies</li>
<li><a href="http://leafletjs.com/download.html">Leaflet 0.5.1</a></li>
</ul><h2>Backbone.Leaflet.GeoModel</h2>

<p>The <code>GeoModel</code> is a <a href="http://backbonejs.org/#Model">Backbone Model</a> to work with <a href="http://geojson.org/">GeoJSON</a>.</p>

<p>When using <code>GeoModel</code> the method <code>toJSON</code> will return a JSON object following the <a href="http://geojson.org/geojson-spec.html">GeoJSON format specification</a>. On the other hand you can use either a common JSON or a <a href="http://geojson.org/geojson-spec.html#feature-objects">GeoJSON object with the type "Feature"</a> as an input data. All other methods works as in ordinary Backbone's model.</p>

<h3>Creating a <code>GeoModel</code> Instance</h3>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">geojsonFeature</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Feature"</span><span class="p">,</span>
  <span class="s2">"properties"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Coors Field"</span><span class="p">,</span>
    <span class="s2">"amenity"</span><span class="o">:</span> <span class="s2">"Baseball Stadium"</span><span class="p">,</span>
    <span class="s2">"popupContent"</span><span class="o">:</span> <span class="s2">"This is where the Rockies play!"</span>
  <span class="p">},</span>
  <span class="s2">"geometry"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Point"</span><span class="p">,</span>
    <span class="s2">"coordinates"</span><span class="o">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">104.99404</span><span class="p">,</span> <span class="mf">39.75621</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">geoModel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Leaflet</span><span class="p">.</span><span class="nx">GeoModel</span><span class="p">(</span> <span class="nx">geojsonFeature</span> <span class="p">);</span>

</pre></div>

<h2>Backbone.Leaflet.GeoCollection</h2>

<p>The <code>GeoCollection</code> is a <a href="http://backbonejs.org/#Collection">Backbone Collection</a> to work with GeoJSON and <code>GeoModel</code>. You can create a new collection using either an array of <code>GeoModels</code> or a <a href="http://geojson.org/geojson-spec.html#feature-collection-objects">GeoJSON object with the type "FeatureCollection"</a>. The <code>toJSON</code> method will return a GeoJSON object.</p>

<h3>Creating a <code>GeoCollection</code> Instance Using "FeatureCollection" GeoJSON</h3>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">geojsonFeatureCollection</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"FeatureCollection"</span><span class="p">,</span>
  <span class="s2">"features"</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Feature"</span><span class="p">,</span>
      <span class="s2">"geometry"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Point"</span><span class="p">,</span>
        <span class="s2">"coordinates"</span><span class="o">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">46.6368</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.5100</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Feature"</span><span class="p">,</span>
      <span class="s2">"geometry"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"Point"</span><span class="p">,</span>
        <span class="s2">"coordinates"</span><span class="o">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">46.6156</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.5016</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">geoCollection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Leaflet</span><span class="p">.</span><span class="nx">GeoCollection</span><span class="p">(</span> <span class="nx">geojsonFeatureCollection</span> <span class="p">);</span>

</pre></div>

<h2>Backbone.Leaflet.MapView</h2>

<p>The <code>MapView</code> is a <a href="http://backbonejs.org/#View">Backbone View</a> to display <code>GeoCollection</code> on <a href="http://leafletjs.com/">Leaflet</a> map using <a href="http://developer.mapquest.com/web/products/open/map">MapQuest-OSM</a> tiles.</p>

<p>There are some functions that can be override to customize the map behavior and appearance.</p>

<ul>
<li>
<strong>getTileLayer()</strong> - Function that will be used to get an instance of <code>L.TileLayer</code>. Can be overridden to use another tiles server.</li>
<li>
<strong>modelFilter( model )</strong> - Function that receives a model and returns <code>true</code> if the model should be added to map, otherwise <code>false</code>. Can be overridden but is recommended to use the <code>filter</code> option.</li>
<li>
<strong>layerStyle( model )</strong> - Function that receives a model and returns the <a href="http://leafletjs.com/reference.html#path-options">Leaflet style options</a> used to define the layer appearance. Can be overridden but is recommended to use the <code>style</code> option.</li>
</ul><h3>Constructor Options</h3>

<p>The <code>mapView</code> constructor allows some options.</p>

<ul>
<li>
<strong>collection</strong> - <code>GeoCollection</code> instance.</li>
<li>
<strong>el</strong> - DOM element used to render the map.</li>
<li>
<strong>map</strong> - <a href="http://leafletjs.com/reference.html#map-options">Leaflet Map options</a> (optional).</li>
<li>
<strong>popup</strong> - <a href="http://leafletjs.com/reference.html#popup-options">Leaflet Popup options</a> (optional).</li>
<li>
<strong>popupView</strong> - Constructor of Backbone view used to render the popup content (optional).</li>
<li>
<strong>layer</strong> - <a href="http://leafletjs.com/reference.html#geojson-options">Leaflet GeoJSON Layer options</a> (optional). It is not recommended to set custom callbacks using this option because this will override some important functions used internally.</li>
<li>
<strong>style</strong> - <a href="http://leafletjs.com/reference.html#path-options">Leaflet style options</a> or a function that receives a model and should return a style options object (optional). Prefer using this option instead of override <code>layerStyle</code> function or <code>layer.style</code> option.</li>
<li>
<strong>filter</strong> - Function that will receive a model and should return <code>true</code>if the model should be added to map or <code>false</code> if not (optional). Prefer using this option instead of override <code>modelFilter</code> function or <code>layer.filter</code> option.</li>
</ul><h3>Creating a Simple Map</h3>

<p>Use <code>MapView</code> just like any other <code>Backbone</code> view.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">mapView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Leaflet</span><span class="p">.</span><span class="nx">MapView</span><span class="p">({</span>

  <span class="nx">el</span><span class="o">:</span> <span class="s1">'#map'</span><span class="p">,</span>

  <span class="nx">collection</span><span class="o">:</span> <span class="nx">geoCollection</span><span class="p">,</span>  <span class="c1">// See above how to create a `GeoCollection` instance.</span>

  <span class="nx">map</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">...</span>  <span class="c1">// Leaflet map options (optional).</span>
  <span class="p">}</span>

<span class="p">});</span>
</pre></div>

<p>For more informations about map options see the <a href="http://leafletjs.com/reference.html#map-constructor">Leaflet documentation</a>.</p>

<h3>Delegating Map Events</h3>

<p>To delegate map events just define the <code>events</code> property like you usually do but use <em>"map"</em> as selector to Leaflet map events. To delegate <a href="http://leafletjs.com/reference.html#ilayer">Layers</a> (markers, polygons, etc) events use <em>"layer"</em> as selector.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyMapView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Leaflet</span><span class="p">.</span><span class="nx">MapView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">'click map'</span><span class="o">:</span> <span class="s1">'onClick'</span><span class="p">,</span>
    <span class="s1">'move map'</span><span class="o">:</span> <span class="s1">'onMove'</span><span class="p">,</span>
    <span class="s1">'click layer'</span><span class="p">,</span> <span class="s1">'onLayerClick'</span>
  <span class="p">},</span>

  <span class="nx">onClick</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">evt</span> <span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">},</span>

  <span class="nx">onMove</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">evt</span> <span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">},</span>

  <span class="nx">onLayerClick</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">evt</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>  <span class="c1">// Get the Leaflet "layer" object.</span>
    <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="nx">layer</span> <span class="p">);</span>  <span class="c1">// Get the Backbone model associated to the "layer".</span>
    <span class="p">...</span>
  <span class="p">}</span>

<span class="p">});</span>


<span class="kd">var</span> <span class="nx">myMapView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyMapView</span><span class="p">({</span>
  <span class="p">...</span>  <span class="c1">// View options.</span>
<span class="p">});</span>

</pre></div>

<p>For more informations about Leaflet events see the <a href="http://leafletjs.com/reference.html#map-events">map events reference</a>.</p>

<h2>Backbone.Leaflet.SatelliteView</h2>

<p>The <code>SatelliteView</code> works similar to <code>MapView</code>, except that uses <a href="http://developer.mapquest.com/web/products/open/map">MapQuest Open Aerial</a> tiles.</p>

<h2>Backbone.Leaflet.PopupView</h2>

<p>Backbone View used to render the popup content. You can extend this view to create a more complex popup and use the <code>MapView</code> <code>popupView</code> option to use your custom view.</p>

<h2>Contributing</h2>

<p>Indent your code with 2 spaces, strip trailing whitespace and take care to maintain the existing coding style. Add unit tests for any new or changed functionality. Lint and test your code using grunt.</p>

<p>Also, please don't edit files in the <em>"dist"</em> subdirectory as they are generated via grunt. You'll find source code in the <em>"src"</em> subdirectory!</p>

<h2>License</h2>

<p>Copyright (c) 2013 Luiz Armesto Licensed under the MIT license.</p>
        </section>

        <footer>
          Backbone.leaflet is maintained by <a href="https://github.com/LuizArmesto">LuizArmesto</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-40075525-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>